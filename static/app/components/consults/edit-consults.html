<md-card class="edit-page-size">
  <md-card-title>
    <md-card-title-text>
      <span class="md-headline">Consultation Detail</span>
      <span class="md-subhead">
        Patient: {{svc.patient.lastName}},{{svc.patient.firstName}}&nbsp;&nbsp;&nbsp;
        Date Of Birth: {{svc.patient.dob}}&nbsp;&nbsp;&nbsp;
        Consultation ID: {{svc.currentConsult.consultId}}
      </span>
    </md-card-title-text>
  </md-card-title>
  <md-card-content>

    <!--dictionary selection pane. Don't put too many list items as it will be too slow-->
    <md-sidenav md-component-id="searchDictPane" class="md-sidenav-right">
      <md-content class="md-padding">
        <h4>Word Categories</h4>

        <md-tabs md-selected="svc.selectedTabIndex" md-dynamic-height="true">
          <md-tab ng-repeat="tag in svc.allTags" label="{{tag.cs}}">
            <md-button ng-click="svc.onBackoutWordExpand()" ng-show="svc.getPreviousTag()">
              <md-icon>arrow_back</md-icon>
              {{svc.getPreviousTag().cs}}
            </md-button>
            <md-list layout="row" layout-wrap>
              <md-list-item ng-repeat="child in tag.children" ng-click="svc.onClickWord(child)" class="md-2-line">
                <div class="md-list-item-text" layout="column">
                  <h4>{{ child.cc }} | {{ child.cs }}</h4>
                  <h4>{{ child.eng1 }}</h4>
                </div>
              </md-list-item>
            </md-list>
          </md-tab>
        </md-tabs>
      </md-content>
    </md-sidenav>

    <!--consultation input fields-->
    <!--todo textarea sometimes not expand to show full text-->
    <form name="userForm">
      <br>
      <div layout="row">
        <md-input-container class="md-block">
          <label>Visited On</label>
          <input ng-model="svc.currentConsult.visitedOn" type="date">
        </md-input-container>
      </div>
      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Chief Complaint</label>
            <textarea ng-model="svc.currentConsult.chiefComplaint" required></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'chiefComplaint')"
                   class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Medical History</label>
            <textarea ng-model="svc.currentConsult.medicalHistory"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'medicalHistory')"
                   class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Symptoms</label>
            <textarea ng-model="svc.currentConsult.symptoms"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'symptoms')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Pulse</label>
            <textarea ng-model="svc.currentConsult.pulse"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'pulse')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Tongue</label>
            <textarea ng-model="svc.currentConsult.tongue"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'tongue')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>TCM diagnosis</label>
            <textarea ng-model="svc.currentConsult.tcmDiagnosis"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'tcmDiagnosis')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>TCM syndrome differentiation</label>
            <textarea ng-model="svc.currentConsult.tcmSyndromeDiff"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'tcmSyndromeDiff')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Western Medicine Diagnosis</label>
            <textarea ng-model="svc.currentConsult.westernMedicineDiagnosis"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'westernMedicineDiagnosis')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Principle of treatment</label>
            <textarea ng-model="svc.currentConsult.principleOfTreatment"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'principleOfTreatment')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Treatment</label>
            <textarea ng-model="svc.currentConsult.treatment"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'treatment')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Acupoints</label>
            <textarea ng-model="svc.currentConsult.acupoints"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'acupoints')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Herbs</label>
            <textarea ng-model="svc.currentConsult.herbs"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'herbs')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <div layout="row">
        <div flex>
          <md-input-container class="md-block">
            <label>Advice</label>
            <textarea ng-model="svc.currentConsult.advice"></textarea>
          </md-input-container>
        </div>
        <md-button ng-click="svc.onOpenSearchDictPane($event, 'advice')" class="md-icon-button md-icon-input-align">
          <md-icon>search</md-icon>
        </md-button>
      </div>

      <md-button class="md-raised md-primary" ng-click="svc.onSubmitConsult($event, userForm)">Submit</md-button>
      <md-button class="md-raised md-primary" ng-click="svc.onCancelConsultForm($event)">Cancel</md-button>
      <md-button id="deletePatient" ng-click="svc.onDeleteConsult()"
                 ng-if="svc.currentConsult.consultId" class="md-raised md-warn">Delete Consultation
      </md-button>
    </form>
  </md-card-content>
</md-card>
