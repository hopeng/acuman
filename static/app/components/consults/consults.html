<div ng-init="svc = consultCtrl"></div>

<ng-include ng-show="svc.upserting" src="'app/components/consults/edit-consults.html'"></ng-include>

<md-card ng-show="!svc.upserting">
  <md-card-title>
    <md-card-title-text>
      <span class="md-headline">Consultation history for {{svc.patient.lastName}},{{svc.patient.firstName}}</span>
      <span class="md-subhead">
        Patient ID: {{svc.patient.patientId}}&nbsp;&nbsp;&nbsp;
        Date Of Birth: {{svc.patient.dob}}
      </span>
    </md-card-title-text>
    <div flex></div>
    <md-button class="md-fab" ng-click="svc.onConsultEdit($event)">
      <md-icon>add</md-icon>
      <md-tooltip>Add Consultation</md-tooltip>
    </md-button>
    <md-button class="md-fab" ng-click="svc.onFilterConsults($event)">
      <md-icon>filter_list</md-icon>
      <md-tooltip>Filter By Date</md-tooltip>
    </md-button>
    <md-button class="md-fab" ng-click="svc.onExportPatients($event)">
      <md-icon>file_download</md-icon>
      <md-tooltip>Export To Excel</md-tooltip>
    </md-button>

  </md-card-title>
  <md-card-content>
    <md-table-container>
      <table md-table md-progress="svc.consultsListPromise">
        <thead md-head>
        <tr md-row>
          <th md-column><strong></strong></th>
          <th md-column><strong>Visited On</strong></th>
          <th md-column><strong>Chief Complaint</strong></th>
          <th md-column><strong>Symptoms</strong></th>
          <th md-column><strong>TCM diagnosis</strong></th>
          <th md-column><strong>Principle of treatment</strong></th>
          <th md-column><strong>Advice</strong></th>
        </tr>
        </thead>
        <tbody md-body>
        <tr md-row ng-repeat="c in svc.consultsList">
          <td md-cell class="no-padding">
            <md-button class="md-icon-button" ng-click="svc.onConsultEdit($event, c)">
              <md-icon>edit</md-icon>
            </md-button>
          </td>
          <td md-cell>{{c.visitedOn | date:'dd/MM/yyyy'}}</td>
          <td md-cell>{{c.chiefComplaint}}</td>
          <td md-cell>{{c.symptoms}}</td>
          <td md-cell>{{c.tcmDiagnosis}}</td>
          <td md-cell>{{c.principleOfTreatment}}</td>
          <td md-cell>{{c.advice}}</td>
        </tr>
        </tbody>
      </table>
    </md-table-container>
  </md-card-content>
</md-card>
